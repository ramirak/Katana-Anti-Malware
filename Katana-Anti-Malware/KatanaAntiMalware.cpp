#include "KatanaAntiMalware.h"
#include "Security/Whitelisting.h"
#include <QMessageBox>
#include <QDebug>

#include <string>

void ask(QWidget* parent, std::string msg ,void (*f)())
{
    QMessageBox::StandardButton reply;
    reply = QMessageBox::question(parent, "Katana Anti-Malware", msg.c_str(),
        QMessageBox::Yes | QMessageBox::No);
    if (reply == QMessageBox::Yes) {
        f();
    }
}

void ExitProgram() {exit(0);}

KatanaAntiMalware::KatanaAntiMalware(QWidget *parent)
    : QMainWindow(parent)
{
    ui.setupUi(this);

    connect(ui.whitelist_button, &QPushButton::released, this, 
        [parent] { ask(parent, "Initiate scanning process?\nThis may take some time.", InitWhitelist); });

    connect(ui.Exit_Button, &QPushButton::released, this,
        [parent] { ask(parent, "Exit program?\nKatana will keep running in the background.", ExitProgram) ; });

    connect(ui.Training_Button, &QPushButton::released, this,
        [parent] { ask(parent, "Switch to training mode?", ExitProgram); });

    connect(ui.Safe_Mode_Button, &QPushButton::released, this,
        [parent] { ask(parent, "Switch to safe mode?", ExitProgram); });

    connect(ui.Allow_Mode_Button, &QPushButton::released, this,
        [parent] { ask(parent, "Switch to allow mode?", ExitProgram); });

}

KatanaAntiMalware::~KatanaAntiMalware()
{}

